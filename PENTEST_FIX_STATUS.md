# Статус исправления ошибки spawn node ENOENT

## Проблема
Пентест падает с ошибкой: `Failed to spawn Claude Code process: spawn node ENOENT`

## Причина
Библиотека `@anthropic-ai/claude-agent-sdk` запускает процесс `node`, но не находит его в PATH внутри Docker контейнера worker.

## Примененные исправления

1. ✅ Добавлен PATH в docker-compose.yml для worker
2. ✅ Изменен entrypoint для создания симлинка (не сработало из-за прав)
3. ✅ Добавлена команда создания симлинка в Dockerfile (не сработало из-за multi-stage build)
4. ✅ Создан wrapper скрипт `/app/bin/node` в Dockerfile перед `USER pentest`
5. ✅ Добавлен `ENV PATH="/app/bin:$PATH"` в Dockerfile

## Текущий статус

- Dockerfile исправлен ✅
- Wrapper должен создаваться в `/app/bin/node` ✅
- PATH должен включать `/app/bin` ✅
- Образ нужно пересобрать ⏳

## Что нужно сделать

1. Пересобрать образ worker полностью:
   ```bash
   cd /opt/xaker/shannon
   docker-compose stop worker
   docker-compose rm -f worker
   docker-compose build --no-cache worker
   docker-compose up -d worker
   ```

2. Проверить, что wrapper создан:
   ```bash
   docker exec shannon_worker_1 ls -la /app/bin/node
   docker exec shannon_worker_1 printenv PATH
   docker exec shannon_worker_1 which node
   ```

3. Запустить новый пентест

## Если не работает

Альтернативное решение - патчить код библиотеки `@anthropic-ai/claude-agent-sdk` напрямую в node_modules, заменив `'node'` на `'/usr/bin/node'` в spawn вызовах.

